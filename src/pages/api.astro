---
import Layout from '../layouts/BlogPost.astro';
---

<Layout
	title="Simple API Test"
	description="Description"
	pubDate={new Date('February 22, 2026')}
	heroImage="/Vintage-US-Flag.webp"
>

  <button id="btnGet">GET Test</button>
  <button id="btnPost">POST Test</button>

  <p id="result">1) element defined - No Value Set yet</p>

 <script>
  // Runs immediately after the <p> exists (script is after it)
  const resultEl = document.getElementById("result");
  resultEl.textContent = "2) Script Init - No value set";

  document.getElementById("btnGet").addEventListener("click", getTest);
  document.getElementById("btnPost").addEventListener("click", postTest);

  async function getTest() {
    try {
      const response = await fetch("https://simple-api.ptsteam01.workers.dev/api/test");
      if (!response.ok) throw new Error(`HTTP ${response.status}`);

      const data = await response.json();
      resultEl.textContent = JSON.stringify(data);
    } catch (err) {
      resultEl.textContent = "GET error: " + err.message;
    }
  }

  async function postTest() {
    try {
      const response = await fetch("https://simple-api.ptsteam01.workers.dev/api/echo", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ testValue: "Hello API" })
      });
      if (!response.ok) throw new Error(`HTTP ${response.status}`);

      const data = await response.json();
      resultEl.textContent = JSON.stringify(data);
    } catch (err) {
      resultEl.textContent = "POST error: " + err.message;
    }
  }
</script>
</Layout>